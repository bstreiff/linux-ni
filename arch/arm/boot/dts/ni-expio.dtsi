// SPDX-License-Identifier: GPL-2.0
/*
 * Copyright (C) 2016 - 2018 National Instruments
 */

/include/ "zynq-7000.dtsi"

/ {
	model = "NI Expansion I/O Target";
	compatible = "ni,zynq-expio", "xlnx,zynq-7000";

	/* Populated by the bootloader */
	memory@0 {
		device_type = "memory";
		reg = <0 0>;
	};
	chosen { };

	usb_phy0: phy0 {
		compatible = "usb-nop-xceiv";
		#phy-cells = <0>;
	};

	usb_phy1: phy1 {
		compatible = "usb-nop-xceiv";
		#phy-cells = <0>;
	};

	amba {
		smcc@e000e000 {
			#address-cells = <1>;
			#size-cells = <1>;
			arm,addr25 = <0x0>;
			arm,nor-chip-sel0 = <0x0>;
			arm,nor-chip-sel1 = <0x0>;
			arm,sram-chip-sel0 = <0x0>;
			arm,sram-chip-sel1 = <0x0>;
			clock-names = "memclk", "aclk";
			clocks = <&clkc 11>, <&clkc 44>;
			compatible = "arm,pl353-smc-r2p1";
			interrupts = <0 18 4>;
			ranges ;
			reg = <0xe000e000 0x1000>;
			nand@e1000000 {
				compatible = "arm,pl353-nand-r2p1";
				reg = <0xe1000000 0x1000000>;
				bank-width = <1>; /* 8-bit width */
				xlnx,nand-width = <0x8>;

				/* SLCR SMC_CLK_CTRL value, 83MHz clock, 12ns cycle time */
				/* <t_rr t_ar t_clr t_wp t_rea t_wc t_rc> in cycles */
				xlnx,onfi-mode0 = <0x0001021 4 3 2 7 4 10 10>;

				/* SLCR SMC_CLK_CTRL value, 166MHz clock, 6ns cycle time */
				/* <t_rr t_ar t_clr t_wp t_rea t_wc t_rc> in cycles */
				xlnx,onfi-mode1 = <0x0000821 4 2 2 7 4 10 10>;
				xlnx,onfi-mode2 = <0x0000821 4 2 2 5 3 8 7>;
				xlnx,onfi-mode3 = <0x0000821 4 2 2 5 2 7 6>;
				xlnx,onfi-mode4 = <0x0000821 4 2 2 4 2 6 5>;
				xlnx,onfi-mode5 = <0x0000821 4 2 2 3 2 5 4>;

				#address-cells = <1>;
				#size-cells = <1>;
			};
		};
	};

};

&L2 {
	prefetch-data = <1>;
	prefetch-instr = <1>;
	arm,dynamic-clock-gating = <0>;
	arm,standby-mode = <0>;
};

&gem0 {
	#address-cells = <1>;
	#size-cells = <0>;
	phy-mode = "rgmii-id";

	fixed-link {
		speed = <1000>;
		full-duplex;
	};

	/*
	 * All NI Expansion I/O devices have a two-port Ethernet switch
	 * connected to the CPU's Ethernet controller.
	 */
	switch@0 {
		compatible = "marvell,mv88e6085";
		#address-cells = <1>;
		#size-cells = <0>;
		reg = <0>;

		dsa,member = <0 0>;

		ports {
			#address-cells = <1>;
			#size-cells = <0>;

			port@0 {
				reg = <0>;
				label = "cpu";
				ethernet = <&gem0>;

				fixed-link {
					speed = <1000>;
					full-duplex;
				};
			};

			port@1 {
				reg = <1>;
				label = "sw0";
				phy-handle = <&switch0phy0>;
			};

			port@2 {
				reg = <2>;
				label = "sw1";
				phy-handle = <&switch0phy1>;
			};
		};

		mdio {
			#address-cells = <1>;
			#size-cells = <0>;

			switch0phy0: switch0phy0@11 {
				reg = <0x11>;
			};
			switch0phy1: switch0phy1@12 {
				reg = <0x12>;
			};
		};
	};
};

&usb0 {
	usb-phy = <&usb_phy0>;
};

&usb1 {
	usb-phy = <&usb_phy1>;
};
